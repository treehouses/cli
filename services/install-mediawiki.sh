#!/bin/bash

function install {
  # create service directory
  mkdir -p /srv/mediawiki

  # create yml(s)
  {
    echo "version: '3'"
    echo "services:"
    echo "  mediawiki:"
    echo "    image: mediawiki"
    echo "    restart: always"
    echo "    ports:"
    echo "      - '8080:80'"
    echo "    links:"
    echo "      - database"
    echo "    volumes:"
    echo "      - /var/www/html/images"
    # After initial setup, download LocalSettings.php to the same directory as
    # this yaml and uncomment the following line and use compose to restart
    # the mediawiki service
    #echo "      - ./LocalSettings.php:/var/www/html/LocalSettings.php"
    echo "  database:"
    echo "    image: mariadb"
    echo "    restart: always"
    echo "    environment:"
    # @see https://phabricator.wikimedia.org/source/mediawiki/browse/master/includes/DefaultSettings.php"
    echo "      MYSQL_DATABASE: my_wiki"
    echo "      MYSQL_USER: wikiuser"
    echo "      MYSQL_PASSWORD: example"
    echo "      MYSQL_RANDOM_ROOT_PASSWORD: 'yes'"
} > /srv/mediawiki/mediawiki.yml

  # create .env with default values

  # add autorun
  cat << EOF > /srv/mediawiki/autorun
mediawiki_autorun=true

if [ "$mediawiki_autorun" = true ]; then
  treehouses services mediawiki up
fi


EOF
}

# environment var
	# NEEDS REVIEW FOR ACCURACY
function uses_env {
  echo true
}

# add supported arch(es)
	# NEEDS TO BE CHANGED TO GITLAB
function supported_arches {
  echo "armv7l"
}

# add port(s)
	# NEEDS REVIEW FOR ACCURACY
function get_ports {
  echo "80"
}

# add size (in MB)
	# NEEDS REVIEW FOR ACCURACY
function get_size {
  echo "1982"
}

# add description
function get_description {
  echo "MediaWiki is a free server-based software, licensed under the GNU General Public License (GPL). It's designed to run on a large server farm for a website that gets millions of hits per day."
}

# add info
	# NEEDS REVIEW FOR FORMATTING
function get_info {
  echo "https://github.com/treehouses/mediawiki"
  echo
  echo "\"MediaWiki <https://www.mediawiki.org/wiki/Manual:What_is_MediaWiki%3F> is a free server-based software,"
  echo "licensed under the GNU General Public License (GPL)."
  echo "It's designed to run on a large server farm"
  echo "for a website that gets millions of hits per day.\""
}

# add svg icon
function get_icon {
  cat <<EOF
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 270 300">
  <defs/>
  <defs>
    <linearGradient id="a" x1="24" x2="246" y1="238" y2="16" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#0a00b2"/>
      <stop offset="50%" stop-color="red"/>
      <stop offset="100%" stop-color="#fffc00"/>
    </linearGradient>
  </defs>
  <path fill="#fff" d="M51.242 283.882l-.046-35.7h-4.922l-12.558 23.663-12.788-23.667h-4.922v35.7h5.7v-23.36L32.289 279.8h2.668l10.58-19.585.046 23.666h5.658zm30.313-13.465a16.339 16.339 0 00-1.587-7.371 11.726 11.726 0 00-10.833-6.707 12.1 12.1 0 00-11.063 6.761 15.488 15.488 0 00-1.633 7.166 15.245 15.245 0 001.679 7.218 12.194 12.194 0 004.761 4.973 15.1 15.1 0 0012.834.663 10.484 10.484 0 004.187-3.32l-3.082-3.927a8.521 8.521 0 01-6.67 2.958 8.086 8.086 0 01-5.313-1.759 7.558 7.558 0 01-2.645-4.769h19.273q.092-1.224.092-1.887zm-12.42-8.977a6.462 6.462 0 014.692 1.836 7.809 7.809 0 012.254 4.794H62.143a7.89 7.89 0 012.323-4.82 6.534 6.534 0 014.669-1.81zm35.328-15.4v13.976a9.068 9.068 0 00-3.45-2.755 10.682 10.682 0 00-4.462-.918 11.775 11.775 0 00-10.81 6.631 17.384 17.384 0 000 14.613 11.74 11.74 0 0010.81 6.656 10.891 10.891 0 004.623-.969 9.033 9.033 0 003.519-2.908v3.52h5.52v-37.85h-5.75zm-7.222 32.745a6.833 6.833 0 01-3.726-1.045 7.251 7.251 0 01-2.622-2.984 10.911 10.911 0 010-8.977 7.264 7.264 0 012.622-2.984 7.166 7.166 0 017.452 0 7.264 7.264 0 012.622 2.984 10.911 10.911 0 010 8.977 7.251 7.251 0 01-2.622 2.984 6.835 6.835 0 01-3.726 1.045zm19.6 5.1h5.75v-27.24h-5.75v27.237zm21.758-27.543a18.782 18.782 0 00-5.75.867 13.457 13.457 0 00-4.646 2.5l2.254 4.641a9.726 9.726 0 013.381-1.989 12.032 12.032 0 014.071-.714 6.239 6.239 0 014.577 1.53 5.912 5.912 0 011.541 4.386v.408h-6.348q-5.291 0-7.751 2.219a7.545 7.545 0 00-2.461 5.891 7.959 7.959 0 001.127 4.208 7.678 7.678 0 003.2 2.907 10.581 10.581 0 004.83 1.046 10.77 10.77 0 004.715-.944 6.892 6.892 0 003.013-2.729v3.316h5.428v-15.968q0-5.814-2.875-8.7t-8.3-2.882zm-.787 23.258a5.281 5.281 0 01-3.45-1.02 3.378 3.378 0 01-1.242-2.754q0-3.621 4.968-3.621h5.934v3.162a5.86 5.86 0 01-2.369 3.137 6.869 6.869 0 01-3.841 1.1zm60.306-31.419l-8.234 27.288-8.142-27.288h-5.52l-8.322 27.132-8-27.135h-6.21l10.672 35.7h6.394l8.1-26.421 7.958 26.421h6.348l10.672-35.7h-5.7zm9.338 35.7h5.75v-27.236h-5.75v27.237zm30.911 0h6.992l-11.224-15.811 10.258-11.425h-6.9l-11.914 12.241v-22.85h-5.75v37.846h5.75v-7.192l4.278-4.488zm9.568 0h5.75v-27.236h-5.75v27.237zm-128.2-30.857a3.567 3.567 0 002.645-1.043 3.513 3.513 0 001.035-2.574 3.073 3.073 0 00-1.058-2.388 3.781 3.781 0 00-2.622-.95 3.677 3.677 0 00-2.622 1 3.437 3.437 0 000 4.961 3.677 3.677 0 002.622 1zm90.62 0a3.569 3.569 0 002.645-1.042 3.513 3.513 0 001.035-2.574 3.077 3.077 0 00-1.058-2.388 3.784 3.784 0 00-2.622-.95 3.674 3.674 0 00-2.622 1 3.437 3.437 0 000 4.961 3.674 3.674 0 002.622 1zm40.479 0a3.569 3.569 0 002.645-1.043 3.513 3.513 0 001.035-2.574 3.077 3.077 0 00-1.058-2.388 3.784 3.784 0 00-2.622-.95 3.674 3.674 0 00-2.622 1 3.437 3.437 0 000 4.961 3.674 3.674 0 002.622 1z"/>
  <g fill="url(#a)">
    <path d="M103.283 45.02c-.647 8.246.645 16.05 5.16 23.1a23.041 23.041 0 0013.04 9.63 5.672 5.672 0 004.719-1.153c6.093-5.8 9.031-12.89 8-21.625-1.829-15.522-11.06-26.108-22.808-36.2-4.568 8.766-7.394 17.145-8.111 26.248z" class="petal"/>
    <path d="M86.913 53.254c1.081 8.2 3.968 15.565 9.849 21.519a23.04 23.04 0 0014.757 6.709 5.673 5.673 0 004.376-2.109c4.754-6.944 6.154-14.486 3.331-22.816-5.016-14.8-16.246-23.238-29.836-30.668-2.647 9.528-3.671 18.311-2.477 27.365z" class="petal"/>
    <path d="M72.611 64.711c2.762 7.8 7.117 14.4 14.108 19a23.04 23.04 0 0015.83 3.494 5.673 5.673 0 003.842-2.973c3.206-7.78 3.007-15.449-1.486-23.01-7.984-13.436-20.722-19.352-35.56-23.793-.608 9.871.216 18.671 3.266 27.282z" class="petal"/>
    <path d="M61 78.891c4.323 7.052 9.955 12.605 17.75 15.653a23.04 23.04 0 0016.21.126 5.671 5.671 0 003.14-3.707c1.519-8.277-.27-15.737-6.237-22.2-10.6-11.483-24.293-14.621-39.73-15.881 1.462 9.784 4.099 18.225 8.867 26.009z" class="petal"/>
    <path d="M52.6 95.174c5.694 6 12.358 10.26 20.617 11.62a23.038 23.038 0 0015.883-3.246 5.673 5.673 0 002.3-4.279c-.235-8.412-3.536-15.337-10.716-20.416-12.759-9.028-26.8-9.251-42.164-7.274 3.459 9.265 7.793 16.973 14.08 23.595z" class="petal"/>
    <path d="M47.764 112.849c6.817 4.684 14.222 7.467 22.582 7.08a23.035 23.035 0 0014.86-6.478 5.671 5.671 0 001.36-4.663c-1.979-8.179-6.647-14.266-14.727-17.742C57.483 84.868 43.7 87.57 29.086 92.7c5.314 8.341 11.152 14.979 18.678 20.149z" class="petal"/>
    <path d="M46.709 131.144c7.642 3.164 15.463 4.346 23.561 2.23a23.043 23.043 0 0013.189-9.426 5.671 5.671 0 00.361-4.844c-3.636-7.589-9.468-12.573-18.094-14.293-15.328-3.058-28.248 2.45-41.477 10.5 6.929 7.062 14.024 12.34 22.46 15.833z" class="petal"/>
    <path d="M49.481 149.257c8.133 1.506 16.029 1.037 23.509-2.717a23.041 23.041 0 0010.941-11.962 5.67 5.67 0 00-.654-4.813c-5.135-6.667-11.876-10.33-20.67-10.219-15.629.2-27.121 8.27-38.386 18.9 8.244 5.461 16.279 9.154 25.26 10.811z" class="petal"/>
    <path d="M55.958 166.4c8.268-.218 15.894-2.319 22.431-7.546a23.037 23.037 0 008.211-13.976 5.67 5.67 0 00-1.64-4.572c-6.409-5.454-13.764-7.635-22.343-5.7-15.243 3.443-24.806 13.73-33.617 26.469 9.2 3.625 17.83 5.565 26.958 5.325z" class="petal"/>
    <path d="M65.857 181.82c8.042-1.933 15.065-5.573 20.372-12.045a23.039 23.039 0 005.129-15.375 5.672 5.672 0 00-2.555-4.131c-7.4-4-15.05-4.606-23.039-.928-14.2 6.536-21.413 18.586-27.381 32.878 9.754 1.634 18.596 1.734 27.474-.399z" class="petal"/>
    <path d="M78.747 194.845c7.465-3.562 13.577-8.583 17.422-16.017a23.039 23.039 0 001.82-16.108 5.671 5.671 0 00-3.358-3.51c-8.073-2.375-15.679-1.376-22.728 3.883-12.529 9.344-17.08 22.631-19.947 37.852 9.88-.427 18.55-2.167 26.791-6.1z" class="petal"/>
    <path d="M94.062 204.906c6.561-5.036 11.5-11.219 13.712-19.289a23.042 23.042 0 00-1.569-16.135 5.67 5.67 0 00-4.014-2.735c-8.391-.645-15.623 1.914-21.425 8.523-10.312 11.746-12 25.689-11.641 41.173 9.575-2.472 17.695-5.977 24.937-11.537z" class="petal"/>
    <path d="M111.135 211.562c5.371-6.29 8.912-13.363 9.4-21.718a23.035 23.035 0 00-4.89-15.456 5.666 5.666 0 00-4.5-1.84c-8.341 1.113-14.883 5.119-19.184 12.791-7.644 13.633-6.4 27.622-2.826 42.693 8.859-4.409 16.072-9.525 22-16.47z" class="petal"/>
    <path d="M129.219 214.524c3.945-7.27 5.939-14.924 4.68-23.2a23.038 23.038 0 00-8-14.1 5.674 5.674 0 00-4.78-.866c-7.927 2.823-13.494 8.1-16.106 16.5-4.643 14.924-.516 28.349 6.112 42.348 7.747-6.153 13.739-12.657 18.094-20.682z" class="petal"/>
    <path d="M147.523 213.661c2.348-7.931 2.706-15.833-.245-23.665a23.042 23.042 0 00-10.753-12.131 5.671 5.671 0 00-4.855.147c-7.167 4.41-11.514 10.731-12.323 19.489-1.439 15.563 5.389 27.837 14.783 40.152 6.294-7.629 10.802-15.237 13.393-23.992z" class="petal"/>
    <path d="M165.248 209.011c.648-8.246-.645-16.049-5.16-23.1a23.038 23.038 0 00-13.04-9.631 5.67 5.67 0 00-4.719 1.154c-6.093 5.8-9.031 12.89-8 21.624 1.829 15.523 11.06 26.108 22.808 36.2 4.569-8.765 7.397-17.144 8.111-26.247z" class="petal"/>
    <path d="M181.619 200.778c-1.081-8.2-3.968-15.565-9.849-21.519a23.043 23.043 0 00-14.758-6.709 5.669 5.669 0 00-4.375 2.109c-4.754 6.944-6.155 14.486-3.331 22.816 5.015 14.8 16.245 23.238 29.835 30.668 2.648-9.529 3.672-18.313 2.478-27.365z" class="petal"/>
    <path d="M195.92 189.321c-2.762-7.8-7.117-14.4-14.108-19a23.04 23.04 0 00-15.83-3.494 5.668 5.668 0 00-3.841 2.972c-3.207 7.781-3.008 15.45 1.485 23.01 7.984 13.437 20.723 19.353 35.56 23.8.608-9.877-.216-18.682-3.266-27.288z" class="petal"/>
    <path d="M207.527 175.14c-4.323-7.051-9.956-12.6-17.751-15.652a23.039 23.039 0 00-16.21-.127 5.672 5.672 0 00-3.139 3.707c-1.519 8.277.27 15.737 6.237 22.2 10.6 11.483 24.293 14.622 39.73 15.881-1.458-9.783-4.094-18.224-8.867-26.009z" class="petal"/>
    <path d="M215.931 158.857c-5.694-6-12.358-10.26-20.616-11.62a23.04 23.04 0 00-15.883 3.247 5.669 5.669 0 00-2.3 4.278c.236 8.412 3.536 15.337 10.716 20.416 12.759 9.028 26.8 9.251 42.164 7.274-3.459-9.265-7.794-16.973-14.081-23.595z" class="petal"/>
    <path d="M220.767 141.182c-6.817-4.684-14.222-7.467-22.582-7.08a23.039 23.039 0 00-14.86 6.478 5.671 5.671 0 00-1.361 4.663c1.979 8.179 6.648 14.267 14.727 17.742 14.357 6.178 28.14 3.477 42.755-1.651-5.311-8.344-11.153-14.982-18.679-20.152z" class="petal"/>
    <path d="M221.822 122.888c-7.642-3.164-15.463-4.347-23.561-2.23a23.031 23.031 0 00-13.188 9.426 5.668 5.668 0 00-.361 4.844c3.636 7.588 9.468 12.573 18.093 14.292 15.328 3.058 28.248-2.45 41.477-10.5-6.928-7.061-14.023-12.34-22.46-15.832z" class="petal"/>
    <path d="M219.05 104.774c-8.132-1.506-16.028-1.037-23.509 2.717a23.042 23.042 0 00-10.941 11.962 5.673 5.673 0 00.654 4.814c5.135 6.666 11.876 10.329 20.67 10.218 15.629-.2 27.121-8.27 38.387-18.9-8.245-5.461-16.282-9.149-25.261-10.811z" class="petal"/>
    <path d="M212.573 87.632c-8.268.218-15.894 2.319-22.43 7.546a23.038 23.038 0 00-8.215 13.975 5.672 5.672 0 001.64 4.572c6.409 5.454 13.764 7.635 22.343 5.7 15.246-3.441 24.809-13.728 33.619-26.467-9.2-3.63-17.83-5.567-26.957-5.326z" class="petal"/>
    <path d="M202.674 72.212c-8.042 1.932-15.065 5.573-20.372 12.045a23.036 23.036 0 00-5.129 15.378 5.67 5.67 0 002.555 4.131c7.4 4 15.05 4.606 23.039.928 14.2-6.536 21.413-18.586 27.381-32.878-9.748-1.638-18.596-1.738-27.474.396z" class="petal"/>
    <path d="M189.785 59.186c-7.465 3.562-13.577 8.583-17.423 16.017a23.039 23.039 0 00-1.82 16.108 5.672 5.672 0 003.358 3.51c8.073 2.376 15.679 1.376 22.729-3.883 12.528-9.345 17.08-22.632 19.947-37.853-9.876.428-18.551 2.169-26.791 6.101z" class="petal"/>
    <path d="M174.469 49.126c-6.561 5.036-11.5 11.218-13.712 19.289a23.046 23.046 0 001.569 16.135 5.673 5.673 0 004.015 2.735c8.39.645 15.622-1.913 21.424-8.523 10.312-11.745 12-25.688 11.641-41.173-9.575 2.471-17.694 5.976-24.937 11.537z" class="petal"/>
    <path d="M157.4 42.469c-5.371 6.29-8.912 13.363-9.4 21.718a23.041 23.041 0 004.889 15.456 5.671 5.671 0 004.5 1.84c8.341-1.113 14.883-5.12 19.185-12.791 7.644-13.633 6.4-27.622 2.826-42.693-8.863 4.409-16.075 9.525-22 16.47z" class="petal"/>
    <path d="M139.312 39.507c-3.945 7.27-5.939 14.924-4.68 23.2a23.035 23.035 0 008 14.1 5.67 5.67 0 004.779.865c7.928-2.823 13.494-8.1 16.106-16.5 4.643-14.924.516-28.349-6.112-42.348-7.746 6.154-13.738 12.658-18.093 20.683z" class="petal"/>
    <path d="M121.008 40.37c-2.348 7.931-2.706 15.833.245 23.665a23.042 23.042 0 0010.753 12.131 5.671 5.671 0 004.855-.147c7.167-4.41 11.515-10.731 12.323-19.489 1.439-15.563-5.389-27.837-14.782-40.152-6.294 7.629-10.802 15.237-13.394 23.992z" class="petal"/>
  </g>
</svg>
EOF
}
